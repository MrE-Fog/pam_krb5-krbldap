.TH pam_krb5 8 2006/09/08 "@OS_DISTRIBUTION@" "System Administrator's Manual"

.SH NAME
pam_krb5 \- Kerberos 5 authentication

.SH SYNOPSIS
.B auth required @SECURITYDIR@/pam_krb5.so
.br
.B session optional @SECURITYDIR@/pam_krb5.so
.br
.B account sufficient @SECURITYDIR@/pam_krb5.so
.br
.B password sufficient @SECURITYDIR@/pam_krb5.so

.SH DESCRIPTION
The pam_krb5.so module is designed to allow smooth integration of Kerberos 5
password-checking for applications which use PAM.
@NO_MAN_KRB4@It creates session-specific credential cache files.
@MAN_KRB4@It creates session-specific credential cache files, and can obtain
@MAN_KRB4@Kerberos IV credentials using a krb524 service.
@MAN_AFS@If the system is an AFS client, it will also attempt to obtain tokens
@MAN_AFS@for the local cell, the cell which contains the user's home directory,
@MAN_AFS@and any explicitly-configured cells.

When a user logs in, the module's authentication function performs a simple
password check and, if possible, obtains Kerberos 5
@MAN_KRB4@and Kerberos IV
credentials, caching them for later use.  When the application requests
initialization of credentials (or opens a session), the usual ticket files are
created.  When the application subsequently requests deletion of credentials or
closing of the session, the module deletes the ticket files.  When the
application requests account management, if the module did not participate in
authenticating the user, it will signal libpam to ignore the module.  If the
module did participate in authenticating the user, it will check for an expired
user password and verify the user's authorization using the .k5login file of the
user being authenticated, which is expected to be accessible to the module.

.SH ARGUMENTS

.IP debug
turns on debugging via \fBsyslog\fR(3).  Debugging messages are logged with
priority LOG_DEBUG.

.IP addressless
tells pam_krb5.so to obtain credentials without address lists.  This may be
necessary if your network uses NAT, and should otherwise not be used.  This
option is deprecated in favor of the \fInoaddresses\fR flag in the
\fIlibdefaults\fR section of \fBkrb5.conf\fR(5).

.IP hosts=\fIhost\fR
tells pam_krb5.so to obtain credentials using the address of the given host in
addition to the addresses of interfaces on the local workstation.  For example,
if your workstation is behind a masquerading firewall, specifying the
firewall's outward-facing address here should allow Kerberos authentication to
succeed.  This option is deprecated in favor of the \fIextra_addresses\fR flag
in the \fIlibdefaults\fR section of \fBkrb5.conf\fR(5).

@MAN_AFS@.IP "afs_cells=\fIcell1.example.com cell2.example.com\fR"
@MAN_AFS@tells pam_krb5.so to obtain tokens for cell1.example.com and
@MAN_AFS@cell2.example.com, in addition to the local cell, for the user.
@MAN_AFS@in addition to the local cell, for the user.  The module will guess
@MAN_AFS@the principal name of the AFS service for the named cells, or it can
@MAN_AFS@be specified by giving cells in the form
@MAN_AFS@\fIcellname\fB=principalname\fR.
@MAN_AFS@
.IP "banner=\fIKerberos 5\fR"
tells pam_krb5.so how to identify itself when users attempt to change their
passwords.  The default setting is "Kerberos 5".

.IP ccache_dir=\fI@default_ccache_dir@\fR
tells pam_krb5.so which directory to use for storing credential caches.  The
default setting is \fI@default_ccache_dir@\fR.

.IP existing_ticket
tells pam_krb5.so to accept the presence of pre-existing Kerberos credentials
provided by the calling application in the default credential cache as
sufficient to authenticate the user, and to skip any account management checks.
.IP
DANGER!  Unless validation is also in use, it is relatively easy to produce a
credential cache which looks "good enough" to fool pam_krb5.so.

.IP external
.IP external=\fIsshd\fR
tells pam_krb5.so to use Kerberos credentials provided by the calling
application during session setup.
@MAN_KRB4@This is most often useful for obtaining
@MAN_KRB4@@MAN_AFS@AFS tokens or
@MAN_KRB4@a krb4 ticket.
@NO_MAN_KRB4@@MAN_AFS@This is most often useful for obtaining AFS tokens.

.IP forwardable
tells pam_krb5.so that credentials it obtains should be forwardable.  This
option is deprecated in favor of the \fIforwardable\fR option in the
\fIlibdefaults\fR section of \fBkrb5.conf\fR(5).

.IP ignore_unknown_principals
.IP ignore_unknown_spn
.IP ignore_unknown_upn
specifies that not pam_krb5 should return a PAM_IGNORE code to libpam
instead of PAM_USER_UNKNOWN for users for whom the determined principal
name is expired or does not exist.

.IP keytab=\fI@DEFAULT_KEYTAB@\fR
tells pam_krb5.so the location of a keytab to use when validating
credentials obtained from KDCs.

@MAN_KRB4@.IP krb4_convert
@MAN_KRB4@tells pam_krb5.so to obtain Kerberos IV credentials for users, in
@MAN_KRB4@addition to Kerberos 5 credentials, using either a v4-capable KDC or
@MAN_KRB4@This option is poorly named.
@MAN_KRB4@@MAN_AFS@This option is automatically enabled if AFS is detected.
@MAN_KRB4@
@MAN_KRB4@.IP krb4_convert_524
@MAN_KRB4@tells pam_krb5.so to obtain Kerberos IV credentials for users using
@MAN_KRB4@the krb524 service.  This option modifies the \fBkrb4_convert\fP
@MAN_KRB4@option.  If disabled, pam_krb5 will only attempt
@MAN_KRB4@to obtain Kerberos IV credentials using the KDC.
@MAN_KRB4@
@MAN_KRB4@.IP krb4_use_as_req
@MAN_KRB4@tells pam_krb5.so to obtain Kerberos IV credentials for users using
@MAN_KRB4@the KDC.  This option modifies the \fBkrb4_convert\fP
@MAN_KRB4@option.  If disabled, pam_krb5 will only attempt
@MAN_KRB4@to obtain Kerberos IV credentials using the krb524 service.
@MAN_KRB4@
.IP minimum_uid=\fI0\fR
tells pam_krb5.so to ignore authentication attempts by users with
UIDs below the specified number.

.IP no_initial_prompt
tells pam_krb5.so to not ask for a password before attempting authentication,
and to instead allow the Kerberos library to trigger a request for a password
only in cases where one is needed.  This option directly conflicts with (and is
overridden by) the \fBuse_first_pass\fR option.

.IP no_user_check
tells pam_krb5.so to not check if a user exists on the local system, to skip
authorization checks using the user's .k5login file, and to create ccache files
owned by the current process's UID.  This is useful for situations where a
non-privileged server process needs to use Kerberized services on behalf of
remote users who may not have local access.  Note that such a server should
have an encrypted connection with its client in order to avoid allowing the
user's password to be eavesdropped.

.IP proxiable
tells pam_krb5.so that credentials it obtains should be proxiable.  This
option is deprecated in favor of the \fIproxiable\fR option in the
\fIlibdefaults\fR section of \fBkrb5.conf\fR(5).

.IP realm=\fIrealm\fR
overrides the default realm set in \fI/etc/krb5.conf\fR, which pam_krb5.so
will attempt to authenticate users to.

.IP renew_lifetime=\fI36000\fR
sets the default renewable lifetime for credentials.  This
option is deprecated in favor of the \fIrenew_lifetime\fR option in the
\fIlibdefaults\fR section of \fBkrb5.conf\fR(5).

.IP ticket_lifetime=\fI36000\fR
sets the default lifetime for credentials.

@MAN_AFS@.IP tokens
@MAN_AFS@.IP tokens=\fIimap\fR
@MAN_AFS@signals that pam_krb5.so should create a new AFS PAG and obtain AFS
@MAN_AFS@tokens during authentication in addition to session setup.  This is
@MAN_AFS@primarily useful in server applications which need to access a user's
@MAN_AFS@files but which do not open PAM sessions before doing so.
@MAN_AFS@
.IP try_first_pass
tells pam_krb5.so to check the previously-entered password as with
\fBuse_first_pass\fR, but to prompt the user for another one if the
previously-entered one fails. This is the default mode of operation.

.IP use_first_pass
tells pam_krb5.so to get the user's entered password as it was stored by a
module listed earlier in the stack, usually \fBpam_unix\fR or \fBpam_pwdb\fR,
instead of prompting the user for it.

.IP use_authtok
tells pam_krb5.so to never prompt for new passwords when changing passwords.
This is useful if you are using pam_cracklib.so or pam_passwdqc.so to try to
enforce use of less-easy-to-guess passwords.

.IP use_shmem
.IP use_shmem=\fIsshd\fR
tells pam_krb5.so to pass credentials from the authentication service function
to the session management service function using shared memory, or to do so for
specific services.

.IP validate
.IP "validate=\fIsshd\fR"
tells pam_krb5.so to verify that the TGT obtained from the realm's servers has
not been spoofed.  Note that the process which is performing authentication
must be able to read the \fIkeytab\fR in order for validation to be possible.

.SH FILES
\fI/etc/krb5.conf\fR
.br

.SH "SEE ALSO"
.BR pam_krb5 (5)
.BR krb5.conf (5)
.br

.SH BUGS
Probably, but let's hope not.  If you find any, please file them in the
bug database at http://bugzilla.redhat.com/ against the "pam_krb5" component.

.SH AUTHOR
Nalin Dahyabhai <nalin@redhat.com>
